---
layout: post
category: diy
title: Raspberry для гостиной
---

# Руководства по настройке малинки


## К сведению

**К сведению тех, кто поставил raspbian:** он не содержит медиа кодеков. Поэтому если малинка нужна для фильмов или музыки, то нужно будет ставить еще пакеты или сразу скачивать raspbmc.

**К сведению тех, кто поставил raspbmc:** бывает, что в простое он загружает процессор на 90%. Может, ну его, эти иксы?

<!--more-->

**К сведению тех, кто еще ничего не ставил, но хочет просто подрубить колонки к малинке.** Блин, да. Аудио вытащить с помощью обычных колонок и обычных проводов не получится. Есть вероятность, что необходимый переходник не нужно покупать дополнительно. Речь идет о 4-pole 3.5mm jack <-> 3 RCA (красный и белый "тюльпаны" должны непринужденно суваться в телеки, аудиосистемы и приличные колонки > 10 ватт). Вероятно, что можно найти такой переходник где-то в кладовке или в тумбочке. Редко, когда провода лежат у вас прямо на рабочем столе, а вот кладовки тают массу сюрпризов, если туда заглядвать раз в 10 лет. Искомый переходник я одолжил у арсенала видеокамеры.
Не стоит сувать 3-pole джек в малинку т.к. видео канал и общий соединятся. Говорят, что это дело неприятно шумит \[[1]\].

## Ставим Коди

Да кто в последнее время может радоваться стоковым сборкам? Сперва необходимо будет пробежаться по [единственному мануалу о Коди, который стоит того, чтобы прочесть][настройка коди]. Затем нужна вафля.


## Ловим беспроводной интернет

Открыл я значит каталог компьютерной фирмы, почитал комментарии о заинтересовавших меня моделях. В итоге собрал такую статистику:
дешевые USB-затычки ловят плохо, греются, живут недолго
наличие антенны - однозначно плюс к ловле сигнала (с антенной сигнал ловится лучше, чем с ноутбука или телефона)
свежие дрова и заплатки
 
> TL-WN7200ND works. Can be made as a WiFi AP using hostapd. Need a powered USB hub.

<http://elinux.org/RPi_USB_Wi-Fi_Adapters>

**TL-WN7200ND** в Коди работает без проблем. В дальнейшем разузнаю, на каких тестах и в каких условиях меряют скорость передачи данных.

## USB-xаб

Было две модели usb-хаба: голубенькое безобразие с питанием 5V 2A, и нормальный пацанский вариант в черно-белом, но без блока. Конечно, я беру четкий хаб без блока. Роюсь в шкафах, в коробках от телефонов, перебираю телефонные зарядки возле розетки в поисках приемлемого вольтажа. Дело в том, что 5В сейчас во всех зарядках к телефонам и к большинству остальной мелкой технике. Но ток им нужен не больше пол ампера.

Порадовал меня старенький телефон от HTC. Сам HTC девайс заряжается от USB порта, поэтому сможет обойтись без питания от розетки. На <http://elinux.org/RPi_VerifiedPeripherals#Working_power_Adapters> пишут, что *HTC 5V 1A USB phone charger* - годная вещь для питания малинки. Но этот блок я искал для хаба, а для хаба требуется круглый разъем. Такой разъем имеется на одном слабеньком блоке питания. 



Имеем два блока питания: в одном нас устраивает схема, в другом - провод и разъем. Но как обычно имеется несколько подвохов. Круглый разъем нельзя просто так взять и отпаять от провода, т.к. он является частью монолитного штекера, состоящего из четырех круглых разъемов разной толщины. Универсальности разъем. От этого крестика из пластика выходит провод и идет в блок питания. 

Поступить можно несколькими способами. Отрезать usb разъем от телефонной зарядки и приделать туда круглый штекер скруткой/пайкой/изолентой. А изолента, как назло, будет маячить на самом видном месте! Не мой метод. Квесты надо решать так, как их задумывали разработчики. 

Поэтому следующий вариант, это *разобрать корпуса* и перепаять провода от основания.

Понять, как устроены черные коробочки блоков питания, нам поможет цитата с <http://www.hardforum.ru/t15258/>

> ну если человек сам решил отремонтировать БП, то он по крайней мере должен иметь навыки ремонта электроники.. а в эти навыки входит такой опыт как разбирание "залитых-одноразовых" БП корпусов..
> а делается всё очень просто.. несколько способов
> 1) для новичков неимеющих опыта
> наверняка у корпуса есть шов, в этот шов можно заливать ацетон, постепенно вставляя плоскую отвёртку (с металлической ручкой) и постукивая молотком..
> желательно делать на чём то мягком (лучше всего на коленях, но быть внимательным, чтоб не заехать себе в ляшку отвёрткой).. кстати я до сих пор так открываю, и надо сказать это лучший для меня вариант..
> 2) это я тоже пробовал, но он больше подходит любителям современного оборудования..
> берём паяльную станцию, ставим темпиратру на 280 градусов, интенсивность воздуха на максималку..
> берём плоскую широкую отвёртку( но так чтоб её жало по толщине входило в паз шва), греем.. топырим, греем .. топырим..
> от темпиратуры клей "размокает" отверткой раздвигаем шов..
> 3) самый на мой взгляд удачный.. но я пользуюсь редко..
> кладём в морозилку примерно на час .. вытаскиваем (естественно в перчатках)..
> так же на коленях стучим молотком по краям.. клей трескается, и корпус открывается руками..
>
> все способы мною проверенны, и действуют 100%.. какой из них выберете вы, вам решать.. но открывать без зазубрин и с последующим закрытием, позволяют только эти способы.. распиловка и грубая сила, портит корпус до неузнаваемости..
>
> и ещё.. опыт !! очень важная часть в этом деле..
>
> З.Ы. кстати очень интересно, что он там собрался ремонтировать? ШИМ менять? или думает что там два кондёра три контакта? :D

Для визуалов есть видео

- как пилить <https://www.youtube.com/watch?v=TiviXtlpiAw>
- как стучать <https://www.youtube.com/watch?v=rp2Mw3EF9tg>
- как делать красиво <https://www.youtube.com/watch?v=lrnoFqbzvFM>

В комментариях на английском кто-то советовал воспользоваться бензином. Есть мнение, что можно

> В щель по кругу инсулиновым шприцом загоняю растворитель 2-3 раза. Клей размягчается, и вуаля.﻿

Я поверил в способ с растворителем. Он неплох, но, чтобы делать красиво, нужен опыт. К примеру, я не ожидал, что ацетон начнет разъедать шершавую поверхность пластика и черную краску. Последствия вполне логичные от применения растворителя, но я не ожидал, что это будет происходить, когда растворитель польется не только в щель между половинками корпуса, а потечет по корпусу.


Блок с круглым разъемом был скреплен нестандартными шурупами с "восточно-германскими шляпками" для которых нужны "вилочные отвертки" <http://i2.guns.ru/forums/icons/forum_pictures/005997/5997146.jpg> (заимствована терминология с форума <http://forum.guns.ru/forummessage/125/975628-m24847378.html>, про специальные биты можно еще почитать <http://job4man.ru/rashodnyie-materialyi/bityi-dlya-shurupoverta-nasadki/>).


Я взял блок питания в пакетик и пошел по магазинам инструментов и крепежа. Там мне предлагали набор бит <http://i2.guns.ru/forums/icons/forum_pictures/005997/5997727.jpg> за 420 - 450 рублей. 
На что продавец сказал

> Такая цена заставляет задуматься, пилить или не пилить.

Вспомнил известную цитату из "Золотого теленка", достал тиски, ножовку и биту с плоским шлицем.

Дело оказалось не сложнее, чем лампочку поменять. Вскрытие показало, что блок питания подвергался серьезным нагрузкам и провод у основания перегревался отчего изоляция отвердела. Провод отпаял, перегретую часть отрезал, изоляцию снял и увидел многожильный провод в зеленом цвете. Первый раз видел такой материал. Но цвет окисла подсказал, что это медь и есть мнение <http://forum.cxem.net/index.php?showtopic=73208&st=840#entry1443163>, что

> Медь сейчас такая говёная, что зеленеет сама по себе.

Немного поскрести, обмакнуть во флюс и постыдная зелень скроется. 


И черт меня заставил померить мультиметром напряжение от получившегося блока питания: 5.21V
"Что-то многовато", подумалось мне и пришлось паниковать. Паниковать и трясти людей за плечи, чтобы они ответили на новую проблему.

<http://www.raspberrypi.org/forums/viewtopic.php?f=26&t=45819>

> The allowed voltage range is the normal one (for 5V logic) 5.0V ±5% 

5% = 0.25V - значит все в порядке.

> Supplied voltage by a host or a powered hub ports is between 4.75 V and 5.25 V.

<http://pinouts.ru/Slots/USB.shtml>


## Интересные материалы, которые могут никогда не пригодиться, но они реально интересные

Настройка Samba в Linux <https://www.jeremymorgan.com/tutorials/raspberry-pi/how-to-raspberry-pi-file-server/>

Я обнаружил, что нельзя просто так взять и подключить HDD на 3,5 дюйма к USB (или даже к двум USB портам). Ибо питаются такие диски от 12 вольт. Всё, что я видел, это надругательство над внешними жесткими дисками (кейсами) <https://hackadaycom.files.wordpress.com/2013/08/external-optical-drive-enclosure-file-server.jpg>, которые используют свой источник питания.
А всего-то нужен чип, который бы понимал сата, и гнал бы всю инфу в USB <http://habrahabr.ru/post/128774/>. Такой финт можно провернуть только с маломощными винтами для ноутбуков, либо без всякого обмана дополнительно подвести 12 вольт <http://thestuffwebuild.com/projects/raspberry-pi-web-server/>.

Вот изумительный материал. Все по шагам расписано и в комментах даже отписываются о работающем прототипе <http://ondevices.ru/tech/computers/sata-usb.html>


[1]: http://www.raspberrypi-spy.co.uk/2014/07/raspberry-pi-model-b-3-5mm-audiovideo-jack/
[настройка коди]: http://mymediaexperience.com/raspberry-pi-xbmc-with-raspbmc/
